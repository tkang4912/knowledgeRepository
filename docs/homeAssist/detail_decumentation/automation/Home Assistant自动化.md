# Home Assistant自动化

# 自动化基础

## 理解自动化

所有自动化都由触发器与动作组成，**触发可能还会由条件一起构成**。以下面的自动化例子为例，

当魏不凡回到家时，已经是日落后了：打开客厅的灯。

我们可以把这个自动化分解为下列三个部分

```
触发器     当魏不凡回到家时
触发条件   已经是日落后了
行为      打开客厅的灯
```

第一个部分是自动化的触发器。触发器描述了使自动化执行的事件。在这种情况下，有一个人到了家，这可以通过HA使用传感器或其他设备检测到魏不凡的状态（说人话就是一堆数据）从到家到没到家。

第二个部分是触发条件，触发条件不是一定要存在于自动化中的，但是它可以指定自动化只在某些情况下执行。触发条件将测试系统的状态。这包括当前时间，设备，人员，和一些其它的比如说阳光（计算太阳角度来关窗帘）。在该例子的情况下，我们只想在太阳落山时采取行动。

第三个部分是动作，当自动化被触发满足所有触发条件时候，动作将被执行。例如可以打开灯，设置恒温器的温度，或者激活一个场景。



```
触发器和触发条件之间的区别非常令人困惑，因为很相似。

触发器触发之后才可以对当前系统状态进行评估。

事务：到家。

触发条件：日落之后。

动作：开灯。
```



## 探索内部状态

自动化直接与系统内部状态交互，所以你需要熟悉系统的内部状态。HA通过开发者工作展示了当前状态中可以获取的状态（说人话还是数据）。可获取数据在开发者工具->状态下可以查看。一个实体可以是任何东西。一盏灯，一个开关，一个人甚至是太阳。状态由以下部分组成。

| 名称     | 介绍                       | 举例                |
| :------- | :------------------------- | :------------------ |
| 实体编号 | 与其它实体的独一无二的区别 | `light.living_room` |
| 状态     | 当前设备的状态             | `off`               |
| 属性     | 与设备有关的其它数据       | `brightness`        |

状态的变化可以作为触发器，当前状态可以在触发条件中使用。

为了探索可行的动作，我们可以前往开发者工具->行为查看。动作可以改变任何事情。例如，打开灯、运行脚本或启用场景。每个动作都有一个域和名称。例如，动作light.turn_on 可以打开系统中的任何灯。可以将参数传递给动作，以指示要激活哪个设备或使用哪种颜色。很显然域也是一堆数据，只是代表不同意义而已。

创建自动化

现在你已经粗略了解了可能性，是时候开始着手创造你的第一个自动化了。

